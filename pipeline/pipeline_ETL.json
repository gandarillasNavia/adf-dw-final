{
	"name": "pipeline_ETL",
	"properties": {
		"activities": [
			{
				"name": "Dim Prod",
				"type": "ExecuteDataFlow",
				"dependsOn": [
					{
						"activity": "Limpieza para volver a intentar",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "0.12:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"dataflow": {
						"referenceName": "df_dim_products",
						"type": "DataFlowReference"
					},
					"compute": {
						"coreCount": 8,
						"computeType": "General"
					},
					"traceLevel": "Fine"
				}
			},
			{
				"name": "Dim store",
				"type": "ExecuteDataFlow",
				"dependsOn": [
					{
						"activity": "Dim Prod",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "0.12:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"dataflow": {
						"referenceName": "df_dim_store",
						"type": "DataFlowReference"
					},
					"compute": {
						"coreCount": 8,
						"computeType": "General"
					},
					"traceLevel": "Fine"
				}
			},
			{
				"name": "Dim Fecha",
				"type": "ExecuteDataFlow",
				"dependsOn": [
					{
						"activity": "Dim store",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "0.12:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"dataflow": {
						"referenceName": "df_dim_fecha",
						"type": "DataFlowReference"
					},
					"compute": {
						"coreCount": 8,
						"computeType": "General"
					},
					"traceLevel": "Fine"
				}
			},
			{
				"name": "Hechos Ventas",
				"type": "ExecuteDataFlow",
				"dependsOn": [
					{
						"activity": "Dim Fecha",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "0.12:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"dataflow": {
						"referenceName": "df_hechos_venta",
						"type": "DataFlowReference"
					},
					"compute": {
						"coreCount": 8,
						"computeType": "General"
					},
					"traceLevel": "Fine"
				}
			},
			{
				"name": "Hechos Garantia",
				"type": "ExecuteDataFlow",
				"dependsOn": [
					{
						"activity": "Hechos Ventas",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "0.12:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"dataflow": {
						"referenceName": "df_hechos_garantias",
						"type": "DataFlowReference"
					},
					"compute": {
						"coreCount": 8,
						"computeType": "General"
					},
					"traceLevel": "Fine"
				}
			},
			{
				"name": "Limpieza para volver a intentar",
				"type": "Script",
				"dependsOn": [],
				"policy": {
					"timeout": "0.12:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"linkedServiceName": {
					"referenceName": "ls_sql_dw_final",
					"type": "LinkedServiceReference"
				},
				"typeProperties": {
					"scripts": [
						{
							"type": "Query",
							"text": "DELETE FROM Gold.Hechos_Garantias;\nDELETE FROM Gold.Hechos_Ventas;\n\n-- 2. SEGUNDO: Borrar datos de las Dimensiones (Tablas Padres)\n-- Ahora que no hay hechos, podemos borrar las dimensiones sin violar integridad\nDELETE FROM Gold.Dim_Producto;\nDELETE FROM Gold.Dim_Tienda;\nDELETE FROM Gold.Dim_Fecha;\n\n-- 3. TERCERO: Reiniciar los contadores IDENTITY (Para que los IDs vuelvan a ser 1, 2, 3...)\n-- Solo necesario en tablas que tienen IDENTITY(1,1)\n\n-- Reiniciar Hechos\nDBCC CHECKIDENT ('Gold.Hechos_Ventas', RESEED, 0);\nDBCC CHECKIDENT ('Gold.Hechos_Garantias', RESEED, 0);"
						}
					],
					"scriptBlockExecutionTimeout": "02:00:00"
				}
			}
		],
		"folder": {
			"name": "Gold"
		},
		"annotations": []
	}
}